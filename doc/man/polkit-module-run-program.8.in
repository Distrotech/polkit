.\" 
.\" polkit-module-run-program manual page.
.\" Copyright (C) 2007 David Zeuthen <david@fubar.dk>
.\"
.TH POLKIT-MODULE-RUN-PROGRAM 8
.SH NAME
polkit-module-run-program \- determine policy by running a program
.SH SYNOPSIS
.PP
.HP 31
\fBpolkit-module-run-program.so\fR program=\fI<program>\fR
.SH DESCRIPTION
.PP
This PolicyKit module will run a program every time an action is
requested. For more information about the big picture refer to the
\fIPolicyKit spec\fP which can be found in
.I "@docdir@/spec/polkit-spec.html"
depending on the distribution.

.SH OPTIONS

.TP 3n
.B program=<program>
Absolute path to program to run; this is a mandatory option. Examples:
.B program=/usr/bin/my-program
or
.B program="/path/to/program --foo --bar"

.SH DESCRIPTION
This module will invoke the given program and will export a minimal
environment with values identifying the request. The program
.B SHOULD NOT
have any side effects; it is only invoked to make a decision - not to
alter state on the system. Further, the program is not guaranteed to
run as 
.B uid 0
(e.g. root); it is effectively invoked by a mechanism (such as
\fBhald\fR(7)) that may run as an unprivileged system user.

.PP
If the program fails to run or exits with a non-zero exit code, it
means that the request is denied (same as returning
.B no
- see below). If the program exits with exit code 0,
.I stdout
of the program is examined to determine the result of the decision
(these values map directly to the possible values in the
.I PolKitResult
enumeration):

.I
.TP
.B unknown
The passed action is unknown.
.TP
.B not_authorized
The mechanism / caller (e.g. the program using
.I libpolkit 
that loads this module) is not sufficiently privileged to know the
answer.
.TP
.B no
Access denied.
.TP
.B auth_root
Access denied, but authentication of the caller as root will grant
access to only that caller.
.TP
.B auth_root_keep_session
Access denied, but authentication of the caller as root will grant
access for the remainder of the session the caller stems from.
.TP
.B auth_root_keep_always
Access denied, but authentication of the caller as root will grant
access to the user of the caller in the future.
.TP
.B auth_self
Access denied, but authentication of the caller as himself will grant
access to only that caller.
.TP
.B auth_self_keep_session
Access denied, but authentication of the caller as himself will grant
access for the remainder of the session the caller stems from.
.TP
.B auth_self_keep_always
Access denied, but authentication of the caller as himself will grant
access to the user of the caller in the future.
.TP
.B yes
Access granted.

.PP
For a request concerning decisions for calls via the system message
bus daemon, the environment will contain:

.TP
.B POLKIT_REQUEST_CALLER=1
To identify the request to be concerning a decision about a caller on
the system message bus.
.TP
.B POLKIT_ACTION_ID
An identifier for the action
.TP
.B POLKIT_RESOURCE_ID
Resource identifier
.TP
.B POLKIT_RESOURCE_TYPE
Resource type
.TP
.B POLKIT_CALLER_UID
UNIX user id of the caller
.TP
.B POLKIT_CALLER_DBUS_NAME
Unique name of the caller on the system message bus
.TP
.B POLKIT_CALLER_PID
UNIX process id of the caller
.TP
.B POLKIT_CALLER_SELINUX_CONTEXT
SELinux security context of the caller (only set if SELinux is enabled)
.TP
.B POLKIT_SESSION_CK_IS_ACTIVE
Whether ConsoleKit regards the session as active (only set if the caller belong to a session)
.TP
.B POLKIT_SESSION_CK_IS_LOCAL
Whether ConsoleKit regards the session as local (only set if the caller belong to a session)
.TP
.B POLKIT_SESSION_CK_OBJREF
ConsoleKit session D-Bus object reference (only set if the caller belong to a session)
.TP
.B POLKIT_SESSION_UID
UNIX user ID of the user owning the session (only set if the caller belong to a session)
.TP
.B POLKIT_SEAT_CK_OBJREF
ConsoleKit seat D-Bus object reference of the seat that the session belongs to (only set if the caller belong to a session)

.PP
For a request concerning session-wide decisions the environment will
contain:

.TP
.B POLKIT_REQUEST_SESSION=1
To identify the request to be session-wide.
.TP
.B POLKIT_ACTION_ID
An identifier for the action
.TP
.B POLKIT_RESOURCE_ID
Resource identifier
.TP
.B POLKIT_RESOURCE_TYPE
Resource type
.TP
.B POLKIT_SESSION_CK_IS_ACTIVE
Whether ConsoleKit regards the session as active
.TP
.B POLKIT_SESSION_CK_IS_LOCAL
Whether ConsoleKit regards the session as local
.TP
.B POLKIT_SESSION_CK_OBJREF
ConsoleKit session D-Bus object reference
.TP
.B POLKIT_SESSION_UID
UNIX user ID of the user owning the session
.TP
.B POLKIT_SEAT_CK_OBJREF
ConsoleKit seat D-Bus object reference of the seat that the session belongs to

.SH NOTES
.PP
As PolicyKit modules are heavily used to enforce policy, running a
program on every request may put unneccessary load on the system
unless judicious use of built-in options to confine the module are
employed.

.SH BUGS
.PP
Please send bug reports to either the distribution or the HAL
mailing list, see 
.I "http://lists.freedesktop.org/mailman/listinfo/hal"
on how to subscribe.

.SH SEE ALSO
.PP
\&\fIPolicyKit\fR\|(8),
\&\fIhald\fR\|(8),
\&\fIdbus-daemon\fR\|(1),
\&\fIpolkit-module-builtins\fR\|(8),
\&\fIpolkit-module-default\fR\|(8),
\&\fIpolkit-module-allow-all\fR\|(8),
\&\fIpolkit-module-deny-all\fR\|(8),
\&\fI@sysconfdir@/PolicyKit/policy\fR\|,
\&\fI@sysconfdir@/PolicyKit/PolicyKit.conf\fR\|

.SH AUTHOR
Written by David Zeuthen <david@fubar.dk> with a lot of help from many
others.
